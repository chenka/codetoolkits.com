---
import type { HTMLAttributes } from 'astro/types';

interface Props extends HTMLAttributes<'button'> {
  selector: string | undefined;
}

const { selector } = Astro.props;
---

<button id="copyButton" data-selector={selector}>Copy to Clipboard</button>
<script>
  const copyButton = document.getElementById('copyButton') as HTMLButtonElement;
  const originalButtonText = copyButton.innerText;
  const selector = copyButton.dataset.selector;

  copyButton.addEventListener('click', () => {
    if (!selector) {
        console.error('Selector is undefined or empty');
        return
    }
    const elementToCopy = document.querySelector(selector) as HTMLElement;
    if (elementToCopy) {
      const textToCopy: string = elementToCopy.innerText;
      navigator.clipboard.writeText(textToCopy).then(() => {
        console.log('Text copied to clipboard');
        copyButton.innerText = 'Copied';
        setTimeout(() => {
          copyButton.innerText = originalButtonText;
        }, 2000);
      }).catch((error: Error) => {
        console.error('Error copying text: ', error);
      });
    } else {
      console.error('Element not found for selector:', selector);
    }
  });
</script>
